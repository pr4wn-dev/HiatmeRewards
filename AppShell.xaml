<?xml version="1.0" encoding="UTF-8" ?>
<Shell
    x:Class="HiatMeApp.AppShell"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:HiatMeApp"
    xmlns:vm="clr-namespace:HiatMeApp.ViewModels">
    <Shell.BindingContext>
        <vm:AppShellViewModel />
    </Shell.BindingContext>
    <!-- Custom Flyout Header with Avatar Box (matching website design) -->
    <Shell.FlyoutHeader>
        <Grid BackgroundColor="{StaticResource WebsiteDark}" 
              HeightRequest="140">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="14"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Blue accent bar on left -->
            <BoxView Grid.Column="0" 
                     BackgroundColor="{StaticResource WebsiteAccent}" />
            
            <!-- Avatar Content -->
            <Grid Grid.Column="1" 
                  Padding="16,24,16,16"
                  VerticalOptions="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- Profile Picture (Square) -->
                <!-- Note: avatar.png is excluded from build due to corruption. 
                     The image source will be set programmatically in UpdateFlyoutAvatar -->
                <Image x:Name="FlyoutAvatarImage"
                       Grid.Column="0"
                       Aspect="AspectFill"
                       HeightRequest="60"
                       WidthRequest="60"
                       HorizontalOptions="Start"
                       Margin="0,0,12,0" />
                
                <!-- User Name and Email (in blue) -->
                <VerticalStackLayout Grid.Column="1" 
                                     Spacing="4"
                                     VerticalOptions="Center">
                    <Label Text="{Binding UserName, TargetNullValue='Guest'}"
                           FontSize="16"
                           TextColor="{StaticResource WebsiteAccent}"
                           HorizontalOptions="Start" />
                    <Label Text="{Binding UserEmail, TargetNullValue='Guest@localhost'}"
                           FontSize="14"
                           TextColor="{StaticResource WebsiteAccent}"
                           HorizontalOptions="Start" />
                </VerticalStackLayout>
            </Grid>
        </Grid>
    </Shell.FlyoutHeader>
    <!-- ShellContent for navigation routes -->
    <ShellContent ContentTemplate="{DataTemplate local:LoginPage}"
                  Route="Login"
                  FlyoutItemIsVisible="False" />
    <ShellContent ContentTemplate="{DataTemplate local:HomePage}"
                  Route="Home"
                  FlyoutItemIsVisible="False" />
    <ShellContent ContentTemplate="{DataTemplate local:VehiclePage}"
                  Route="Vehicle"
                  FlyoutItemIsVisible="False" />
    <ShellContent ContentTemplate="{DataTemplate local:FinishDayPage}"
                  Route="FinishDay"
                  FlyoutItemIsVisible="False" />
    <ShellContent ContentTemplate="{DataTemplate local:VehicleIssuesPage}"
                  Route="VehicleIssues"
                  FlyoutItemIsVisible="False" />
    <ShellContent ContentTemplate="{DataTemplate local:ProfilePage}"
                  Route="Profile"
                  FlyoutItemIsVisible="False" />
    <ShellContent ContentTemplate="{DataTemplate local:RequestDayOffPage}"
                  Route="RequestDayOff"
                  FlyoutItemIsVisible="False" />
    <ShellContent ContentTemplate="{DataTemplate local:RegisterPage}"
                  Route="Register"
                  FlyoutItemIsVisible="False" />
    <ShellContent ContentTemplate="{DataTemplate local:ForgotPasswordPage}"
                  Route="ForgotPassword"
                  FlyoutItemIsVisible="False" />
    <!-- MenuItems - all menu items are created programmatically and managed dynamically based on login status -->
    <!-- Footer with Copyright -->
    <Shell.FlyoutFooter>
        <Grid BackgroundColor="{StaticResource WebsiteDark}"
              Padding="16,12">
            <BoxView HeightRequest="1"
                     BackgroundColor="#666666"
                     VerticalOptions="Start"
                     Margin="0,0,0,12" />
            <Label Text="Â© 2025 Hiatme. All rights reserved."
                   FontSize="12"
                   TextColor="White"
                   HorizontalOptions="Center"
                   VerticalOptions="End" />
        </Grid>
    </Shell.FlyoutFooter>
</Shell>